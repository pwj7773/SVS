<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
<meta charset="utf-8" />
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta name="description" content="" />
<meta name="author" content="" />
<!-- Bootstrap core JS-->
	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
	<!-- Core theme JS-->
	<script src="/js/scripts.js"></script>
	<script src="/js/Myscript.js"></script>
<title>[회원 수정]</title>
<script>
	// 회원가입 입력창 검증하는 함수
	// 유효하면 -> 서버로 보냄 아니면 -> 여기서 머무름
	function checkValue() {
		// ID가 비어있거나 3~10자가 아니면 무효
		// 비밀번호가 비어있거나 4~8글자가 아니면 무효
		// 비밀번호 입력창과 비밀번호 확인창의 값이 다르면 무효
		// 이름이 없거나 한글자, 7자이상 무효
		// 이름에 숫자 들어있으면 무효
		// 이메일이 비어있으면 무효
		let userIdValue = document.getElementById("userId").value;
		let pw1Value = document.getElementById("pw1").value;
		let pw2Value = document.getElementById("pw2").value;
		let nameValue = document.getElementById("name").value;
		let emailValue = document.getElementById("email").value;
		let phoneValue = document.getElementById("phone").value;
		
		let namesplit = nameValue.split("");
		
		
		if (userIdValue === '' || userIdValue.length < 3 || userIdValue > 10) {
			alert("잘못된 아이디입니다.");
			document.getElementById("userId").focus(); 
			return false;
		}
		
		if (pw1Value === '' || pw1Value.length < 4 || pw1Value.length > 15) {
			alert("잘못된 비밀번호입니다.");
			document.getElementById("pw1").focus(); 
			return false;
		}
		
		if (pw2Value !== pw1Value) {
			alert("비밀번호가 일치하지 않습니다.");
			document.getElementById("pw2").focus(); 
			return false;
		}
		
		if (nameValue === '' || nameValue.length == 1 || nameValue.length > 7) {
			alert("잘못된 이름입니다.");
			document.getElementById("name").focus(); 
			return false;
		}
		
		for(let i = 0; i < namesplit.length; i++) {
			if(!isNaN(namesplit[i])) {
				alert("이름에는 숫자가 입력되지 않습니다.");
				document.getElementById("name").focus(); 
				return false;
			}	
		}
		
		if (emailValue === '') {
			alert("이메일을 입력하세요.");
			document.getElementById("email").focus();
			return false;
		}
		
		if (phoneValue === '') {
			alert("전화번호를 입력하세요.");
			document.getElementById("phone").focus();
			return false;
		}
	}
	
//	function delmem() {
//		let deletemem = confirm("정말 삭제하시겠습니까?");
//		
//		if (deletemem == true) {
//			return true;
//		} else {
//			return false;
//		}
//	}
</script>
<!-- Core theme CSS (includes Bootstrap)-->
<link href="/css/styles.css" rel="stylesheet" />
</head>
<body>
<div class="d-flex" id="wrapper">
		<!-- Sidebar-->
		<div class="border-end bg-white" id="sidebar-wrapper">
			<div class="sidebar-heading border-bottom bg-light">
				<a href="/loginafter"
					class="d-flex align-items-center mb-3 mb-md-0 me-md-auto link-body-emphasis text-decoration-none">
					<svg class="bi me-2" width="40" height="32"></svg> <span
					class="fs-4"><img src="/img/logo (2).png" width="100px"></span>
				</a>
			</div>
			<div class="list-group list-group-flush">
				<div sec:authorize="hasAnyRole('ADMIN','EMP')">
					<a href="/infoBusiness"
						class="list-group-item list-group-item-action list-group-item-light p-3">
						<svg class="bi pe-none me-1" width="16" height="40">
							<img width="20" src="/img/hotel.png">
					    </svg> 업체관리
					</a>
				</div>
				<div>
					<a th:href="@{/complain/boardList(id='complain')}"
						class="list-group-item list-group-item-action list-group-item-light p-3">
						<svg class="bi pe-none me-1" width="16" height="40">
							<img width="20" src="/img/complain.png">
					    </svg> 민원게시판
					</a>
				</div>
				<div>
					<a href="#"
						class="list-group-item list-group-item-action list-group-item-light p-3">
						<svg class="bi pe-none me-1" width="16" height="40">
							<img width="20" src="/img/clock.png">
					    </svg> 예약통계
					</a>
				</div>
				<div>
					<a href="#"
						class="list-group-item list-group-item-action list-group-item-light p-3">
						<svg class="bi pe-none me-1" width="16" height="40">
							<img width="20" src="/img/statics.png">
					    </svg> 통계분석
					</a>
				</div>
				<div sec:authorize="hasRole('ADMIN')">
					<a href="/adminapproval"
						class="list-group-item list-group-item-action list-group-item-light p-3">
						<svg class="bi pe-none me-1" width="16" height="40">
							<img width="20" src="/img/user.png">
					    </svg> 회원목록관리
					</a>
				</div>
				<div>
					<a href="/loginafter"
						class="list-group-item list-group-item-action list-group-item-light p-3">
						<svg class="bi pe-none me-1" width="16" height="40">
							<img width="20" src="/img/home.png">
					    </svg> 홈화면
					</a>
				</div>

			</div>
		</div>
		<!-- Page content wrapper-->
		<div id="page-content-wrapper">
			<!-- Top navigation-->
			<nav
				class="navbar navbar-expand-lg navbar-light bg-light border-bottom">
				<div class="container-fluid">
					<button class="btn btn-primary" id="sidebarToggle">Toggle
						Menu</button>
					<button class="navbar-toggler" type="button"
						data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
						aria-controls="navbarSupportedContent" aria-expanded="false"
						aria-label="Toggle navigation">
						<span class="navbar-toggler-icon"></span>
					</button>
					<div class="collapse navbar-collapse" id="navbarSupportedContent">
						<ul class="navbar-nav ms-auto mt-2 mt-lg-0">
							<li class="nav-item active"><a class="nav-link" href="#!">Home</a></li>
							<li class="nav-item"><a class="nav-link" href="#!">Link</a></li>
							<li class="nav-item dropdown"><a
								class="nav-link dropdown-toggle" id="navbarDropdown" href="#"
								role="button" data-bs-toggle="dropdown" aria-haspopup="true"
								aria-expanded="false" th:text="${#authentication.name}"></a>
								<div class="dropdown-menu dropdown-menu-end"
									aria-labelledby="navbarDropdown">
									<a class="dropdown-item" href="/memberupdate">회원정보 수정</a> <a
										class="dropdown-item" onclick="confirmLogout()">로그아웃</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item" href="#!">Something else here</a>
								</div></li>
						</ul>
					</div>
				</div>
			</nav>
<div class="container-fluid p-4">
<div class="px-4">
<h3>회원정보 수정</h3>
<form action="/memberupdate" method="post" onsubmit = "return checkValue()">
	<table>
		<tr>
			<th>아이디</th>
			<td>
				<input name="id" type = "text" id = "userId" th:value="${member.id}" readonly="readonly" class="form-control">
			</td>
		</tr>
		<tr>
			<th>비밀번호</th>
			<td>
				<input name="pw" type = "password" id = "pw1" placeholder="비밀번호를 입력하세요" class="form-control">
			</td>
		</tr>
		<tr>
			<th>비밀번호 확인</th>
			<td>
				<input type = "password" id = "pw2" placeholder="비밀번호를 입력하세요" class="form-control">
			</td>
		</tr>
		<tr>
			<th>이름</th>
			<td>
				<input name="name" type = "text" id = "name" th:value="${member.name}" class="form-control">
			</td>
		</tr>
		<tr>
			<th>이메일</th>
			<td>
				<!-- input type = "email" 속성은 입력된 값이 메일주소 형식인지 꼼꼼하게 체크한다 -->
				<input type = "text" name="email" id = "email" th:value="${member.email}" class="form-control">
			</td>
		</tr>
		<tr>
			<th>전화번호</th>
			<td>
				<input type="text" name="phone" id="phone" th:value="${member.phone}" class="form-control">
			</td>
		</tr>
		<tr>
			<th colspan = "2" style="text-align: center;">
				<input type = "submit" value = "수정하기">
		</tr>
	</table>
</form>
<div sec:authorize="hasRole('USER')"><br>
	<a href="insertBusiness">사업장 정보 추가</a><br><br>
	<h3>사업장 정보</h3>
	<table class="table">
		<tr>
			<th>등록 번호</th>
			<th>상호명</th>
			<th>대표</th>
			<th>주소</th>
			<th>연락처</th>
			<th>수정</th>
		</tr>
 			<tr th:each = "b : ${blist}">
			<td><span th:text="${b.businessNum}"></span></td>
			<td><span th:text="${b.businessName}"></span></td>
			<td><span th:text="${b.name}"></span></td>
			<td><span th:text="${b.businessAddress}"></span></td>
			<td><span th:text="${b.phone}"></span></td>
			<td>
				<a th:href="@{/updateBusiness/{businessNum}(businessNum=${b.businessNum})}">수정</a>
			</td>
		</tr>
	</table>
</div>
</div>
</div>
</div>
</div>
</body>
</html>